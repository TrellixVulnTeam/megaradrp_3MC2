language: python
sudo: false

matrix:
  include:
    - python: "2.7"
      env: DEPS="numpy scipy astropy==2.0 enum34"
    - python: "3.5"
      env: DEPS="numpy scipy astropy==3.0" COVERAGE=true
    - python: "3.6"
      env: DEPS="numpy scipy astropy==3.0"

cache:
  pip: true

# The preinstalled numpy 1.15 with python 3.5 breaks something
# probably a wheel
install:
  - pip install Cython
  - pip install "numpy>=1.16"
  - pip install git+git://github.com/guaix-ucm/numina.git#egg=numina
  - pip install $DEPS scikit-image pip pytest setuptools Cython six>=1.7
  - pip install pytest-benchmark pytest-cov
  - if [[ $COVERAGE == true ]]; then pip install coveralls; fi
  - if [[ $COVERAGE == true ]]; then pip install codeclimate-test-reporter; fi

script:
  - py.test -s -v megaradrp
  - if [[ $COVERAGE == true ]]; then py.test megaradrp --cov=megaradrp; fi

after_success:
  - if [[ $COVERAGE == true ]]; then coveralls; fi
  - if [[ $COVERAGE == true ]]; then codeclimate-test-reporter; fi
